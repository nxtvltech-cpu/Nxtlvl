{%- comment -%}
  Product Recommendations Section
{%- endcomment -%}

<section class="product-recommendations section-padding">
  <div class="container">
    <h2 class="section-title">{{ section.settings.heading }}</h2>
    
    <div class="product-grid" id="product-recommendations">
      {%- comment -%} Recommendations loaded via Shopify API {%- endcomment -%}
    </div>
  </div>
</section>

<script>
  fetch('/recommendations/products.json?product_id={{ product.id }}&limit={{ section.settings.products_to_show }}')
    .then(response => response.json())
    .then(({ products }) => {
      const container = document.getElementById('product-recommendations');
      if (products && products.length > 0) {
        products.forEach(product => {
          const card = document.createElement('div');
          card.className = 'product-grid-item';
          card.innerHTML = `
            <a href="${product.url}" class="product-card">
              <img src="${product.featured_image}" alt="${product.title}" loading="lazy">
              <h3>${product.title}</h3>
              <p class="price">${Shopify.formatMoney(product.price)}</p>
            </a>
          `;
          container.appendChild(card);
        });
      }
    });
</script>

<style>
.product-recommendations {
  padding: 4rem 0;
}

.section-title {
  font-size: 2rem;
  font-weight: 700;
  color: var(--nx-green);
  margin-bottom: 2rem;
  text-align: center;
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 2rem;
}
</style>

{% schema %}
{
  "name": "Product Recommendations",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "You may also like"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 10,
      "step": 1,
      "label": "Number of products",
      "default": 4
    }
  ]
}
{% endschema %}
